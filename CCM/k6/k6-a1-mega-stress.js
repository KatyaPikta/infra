// Auto-generated by the postman-to-k6 converter

import "./libs/shim/core.js";
import "./libs/shim/urijs.js";
import { sleep } from "k6";

function randomSleep(minSeconds, maxSeconds) {
    const delay = Math.random() * (maxSeconds - minSeconds) + minSeconds;
    sleep(delay);
}

export const options = { 
  maxRedirects: 4,
  insecureSkipTLSVerify: true ,
  stages: [
  { duration: '30s', target: 100 }, 
  { duration: '30s', target: 200 }, 
  { duration: '30s', target: 400 },
  { duration: '30s', target: 800 }, 
  { duration: '30s', target: 1000 },
  { duration: '30s', target: 800 }, 
  { duration: '30s', target: 400 }, 
  { duration: '30s', target: 200 },
  { duration: '30s', target: 0 },

  ]
};

const Request = Symbol.for("request");
postman[Symbol.for("initial")]({
  options,
  collection: {
    taskId: "0",
    URL: "https://209.38.184.10"
  }
});

export default function() {
  postman[Request]({
    name: "get page",
    id: "03a9c735-f95a-4ea9-8230-9ed6a02c85bc",
    method: "GET",
    address: "{{URL}}",
    headers: {
      "sec-ch-ua":
        '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
      "sec-ch-ua-mobile": "?0",
      "sec-ch-ua-platform": '"Windows"',
      "Upgrade-Insecure-Requests": "1",
      "User-Agent":
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
      Accept:
        "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
      "Sec-Fetch-Site": "none",
      "Sec-Fetch-Mode": "navigate",
      "Sec-Fetch-User": "?1",
      "Sec-Fetch-Dest": "document",
      host: "task2.local"
    },
    post(response) {
      pm.test("Status code is 200", function() {
        pm.response.to.have.status(200);
      });
    }
  });

  randomSleep(0.5, 5);

  postman[Request]({
    name: "get list",
    id: "bb289205-2235-4f6f-b9ba-7709de35c57a",
    method: "GET",
    address: "{{URL}}/api/tasks",
    headers: {
      "sec-ch-ua-platform": '"Windows"',
      "User-Agent":
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
      "sec-ch-ua":
        '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
      "sec-ch-ua-mobile": "?0",
      Accept: "*/*",
      "Sec-Fetch-Site": "same-origin",
      "Sec-Fetch-Mode": "cors",
      "Sec-Fetch-Dest": "empty",
      host: "task2.local"
    },
    post(response) {
      pm.test("Status code is 200", function() {
        pm.response.to.have.status(200);
      });
    }
  });

  randomSleep(0.5, 5);

  postman[Request]({
    name: "post new task",
    id: "d1da1663-d248-4eac-8093-3e6e73d00406",
    method: "POST",
    address: "{{URL}}/api/tasks",
    data: `------WebKitFormBoundaryHmzcdUrTHAJOqZ1D\r
Content-Disposition: form-data; name="description"\r
\r
description {{taskId}}\r
------WebKitFormBoundaryHmzcdUrTHAJOqZ1D\r
Content-Disposition: form-data; name="status"\r
\r
New\r
------WebKitFormBoundaryHmzcdUrTHAJOqZ1D\r
Content-Disposition: form-data; name="title"\r
\r
task {{taskId}}\r
------WebKitFormBoundaryHmzcdUrTHAJOqZ1D--\r
`,
    headers: {
      "sec-ch-ua-platform": '"Windows"',
      "User-Agent":
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
      "sec-ch-ua":
        '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
      "Content-Type":
        "multipart/form-data; boundary=----WebKitFormBoundaryHmzcdUrTHAJOqZ1D",
      "sec-ch-ua-mobile": "?0",
      Accept: "*/*",
      "Sec-Fetch-Site": "same-origin",
      "Sec-Fetch-Mode": "cors",
      "Sec-Fetch-Dest": "empty",
      host: "task2.local"
    },
    post(response) {
      pm.test("Status code is 200", function() {
        pm.response.to.have.status(200);
      });

      var jsonData = pm.response.json();
      pm.collectionVariables.set("taskId", jsonData.id);
      //console.log("Set taskId to " + jsonData.id);
    }
  });

  randomSleep(0.5, 5);

  postman[Request]({
    name: "update task",
    id: "1c4603df-1d67-40a8-99ac-5c2ec0d9db18",
    method: "PATCH",
    address: "{{URL}}/api/tasks/{{taskId}}",
    headers: {
      "sec-ch-ua-platform": '"Windows"',
      "User-Agent":
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
      "sec-ch-ua":
        '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
      "sec-ch-ua-mobile": "?0",
      Accept: "*/*",
      "Sec-Fetch-Site": "same-origin",
      "Sec-Fetch-Mode": "cors",
      "Sec-Fetch-Dest": "empty",
      host: "task2.local"
    },
    post(response) {
      pm.test("Status code is 200", function() {
        pm.response.to.have.status(200);
      });
    }
  });

  randomSleep(0.5, 5);

  postman[Request]({
    name: "delete task",
    id: "38d0da20-b528-444f-86c1-855aa94662a8",
    method: "DELETE",
    address: "{{URL}}/api/tasks/{{taskId}}",
    headers: {
      "sec-ch-ua-platform": '"Windows"',
      "User-Agent":
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
      "sec-ch-ua":
        '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
      "sec-ch-ua-mobile": "?0",
      Accept: "*/*",
      "Sec-Fetch-Site": "same-origin",
      "Sec-Fetch-Mode": "cors",
      "Sec-Fetch-Dest": "empty",
      host: "task2.local"
    },
    post(response) {
      pm.test("Status code is 200", function() {
        pm.response.to.have.status(200);
      });
    }
  });


}
